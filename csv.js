const createCsvWriter = require('csv-writer').createObjectCsvWriter;


function convertJsonToCsv(jsonData, csvFilePath) {
    // Extract header from the first object in the JSON array, excluding numeric properties
    const header = jsonData[0];
    const csvWriter = createCsvWriter({
        path: csvFilePath,
        header: header.map((key, index) => (
            { id: index.toString(), title: key })
        ), 
    });

    // Write the modified JSON data to CSV file
    csvWriter
        .writeRecords(jsonData.slice(1))
        .then(() => console.log('CSV file written successfully'))
        .catch((error) => console.error('Error writing CSV file:', error));
}

// function convertJsonToCsv(jsonData, csvFilePath) {
//     // Extract header from the first object in the JSON array
//     const header = jsonData[0];

//     // Create CSV writer with specified header and file path
//     const csvWriter = createCsvWriter({
//         path: csvFilePath,
//         header: header.map((key, index) => (
//             { id: index.toString(), title: key })
//         ),
//     });

//     // Write the JSON data to CSV file, excluding the first row
//     csvWriter
//         .writeRecords(jsonData.slice(1))
//         .then(() => console.log('CSV file written successfully'))
//         .catch(error => console.error('Error writing CSV file:', error));
// }

// Example usage:
const jsonData = [
    [
        "p_id",
        "or_id",
        "u_id",
        "c_id",
        "p_type",
        "p_status",
        "p_state",
        "p_county",
        "p_apn",
        "p_price",
        "p_price_option",
        "p_acres",
        "p_sqft",
        "p_liens",
        "p_backtaxes",
        "p_improvements",
        "p_power",
        "p_access",
        "p_owned",
        "p_aquired",
        "p_est_value",
        "p_agent_name",
        "p_agent_phone",
        "p_agent_phone_ext",
        "p_seller_agent_name",
        "p_seller_agent_phone",
        "p_comments",
        "p_legal_description",
        "p_listing_status",
        "p_headline",
        "p_sub_headline",
        "p_short_description",
        "p_description",
        "p_custom_html",
        "p_address",
        "p_city",
        "p_terrain",
        "p_average_temperature",
        "p_short_legal",
        "p_zoning",
        "p_average_dimensions",
        "p_base_tax",
        "p_market_value",
        "p_repair_estimate",
        "p_sale_price",
        "p_assessed_value",
        "p_hoa",
        "p_close_notes",
        "p_plat_map_link",
        "p_zip",
        "p_offer_accepts_date",
        "p_option_accepts_date",
        "p_option_expires_date",
        "p_offer_expires_date",
        "p_purchased_on",
        "p_purchase_amount",
        "p_purchase_closing_costs",
        "p_sold_on",
        "p_sold_amount",
        "p_sold_closing_costs",
        "p_beds",
        "p_baths",
        "p_occupancy",
        "p_situation",
        "p_urgency",
        "p_repairs",
        "p_vandalized",
        "p_water_damage",
        "p_foreclosure",
        "p_rent_value",
        "p_min_acceptable_offer",
        "p_highlighted",
        "p_status_create_time",
        "p_status_last_updated",
        "tag_ids",
        "p_listing_order",
        "p_datatree_id",
        "p_assigned_to",
        "p_closing_type",
        "p_closing_company_name_purchase",
        "p_closing_company_address_purchase",
        "p_closing_contact_name_purchase",
        "p_closing_contact_phone_purchase",
        "p_closing_type_sale",
        "p_closing_company_name_sale",
        "p_closing_company_address_sale",
        "p_closing_contact_name_sale",
        "p_closing_contact_phone_sale",
        "p_listing_financing_offered",
        "p_listing_finance_instrument",
        "p_listing_downpayment",
        "p_listing_term",
        "p_listing_payment",
        "p_listing_rate",
        "p_listing_order_link",
        "p_listing_order_post_vars",
        "p_listing_order_link_post_variables",
        "p_max_offer_amount",
        "p_max_option_amount",
        "p_flood",
        "p_flood_description",
        "p_use",
        "p_use_code",
        "p_use_description",
        "p_restrictions",
        "p_waste_system_requirement",
        "p_water_system_requirement",
        "p_environmental",
        "p_impact_fee",
        "p_video",
        "p_directions",
        "p_shapefile",
        "p_map_image",
        "p_map_location",
        "p_score"
    ],
    [
        "132101",
        "52935",
        "1",
        "",
        "Land",
        "1",
        "FL",
        "Brevard",
        "24-36-22-00-786",
        "0",
        "0",
        "1.15",
        "0",
        "0",
        "0",
        "",
        "",
        "",
        "0",
        "",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Y",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "PART OF SE 1/4 OF SE 1/4 AS DES IN DB 405 PG 148 EX ORB 1001 PG 1005",
        "",
        "",
        "0",
        "19320",
        "0",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "0",
        "Y",
        "1644356149",
        "1698807711",
        ",26,",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "",
        "0",
        "0",
        "0",
        "0",
        "",
        "0",
        "",
        "0",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "",
        "",
        "",
        "",
        "",
        ""
    ],
    [
        "132103",
        "52937",
        "1",
        "",
        "Land",
        "1",
        "FL",
        "Brevard",
        "28-37-08-02-2-4",
        "0",
        "0",
        "0.22",
        "0",
        "0",
        "0",
        "{\"house\":\"N\",\"shed\":\"N\",\"mobile_home\":\"N\",\"rv_hookup\":\"N\",\"septic_system\":\"N\",\"well\":\"N\",\"fence\":\"N\",\"pool\":\"N\",\"spa\":\"N\",\"cul_de_sac\":\"N\",\"second_floor\":\"N\",\"basement\":\"N\",\"other\":\"\"}",
        "",
        "",
        "0",
        "",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Y",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "RIBLETS RESUB PART OF LOT 2 AS DES IN ORB 396 PG 426 EX DB 392 PG 589 A/K/A LOTS 11,12 & PT OF LOT 13 BLK 12 OF VACATED PB 5 PG 68",
        "",
        "",
        "0",
        "14060",
        "0",
        "0",
        "0.00",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "0",
        "",
        "0",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "0",
        "Y",
        "1644356149",
        "1699392397",
        "",
        "",
        "",
        ",1,26,29,",
        "Closing Company",
        "",
        "",
        "",
        "",
        "Closing Company",
        "",
        "",
        "",
        "",
        "0",
        "Mortgage",
        "0",
        "0",
        "0",
        "0",
        "",
        "0",
        "",
        "0",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "Sewer",
        "Stored",
        "",
        "0",
        "",
        "",
        "",
        "",
        "",
        ""
    ],
    [
        "138179",
        "59484",
        "1",
        "",
        "Land",
        "2",
        "WA",
        "Grant",
        "161807010",
        "0",
        "0",
        "40",
        "0",
        "0",
        "0",
        "",
        "",
        "",
        "0",
        "",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "47.284265, -119.423841",
        "0",
        "",
        "",
        "SWSW 27 21 27",
        "8000",
        "",
        "0",
        "32000",
        "0",
        "0",
        "32000",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "0",
        "Y",
        "1688064438",
        "1700092258",
        ",26,",
        "",
        "143670101",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "",
        "0",
        "0",
        "0",
        "0",
        "",
        "0",
        "",
        "0",
        "0",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "0",
        "",
        "",
        "",
        "/google-map_1700092257.png",
        "47.284265, -119.423841",
        ""
    ]
];

const csvFilePath = 'output4.csv';
convertJsonToCsv(jsonData, csvFilePath);
